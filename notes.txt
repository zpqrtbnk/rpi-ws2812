
STATUS

test.c is now passing all three tests, start working on leds.c = the SMI thing
at one point... some LEDS were ON when I did plug them correctly
and then running leds.c turned the first one OFF?
but I cannot repro?

ah running bin/leds -t = test mode DOES flash the first led!
-N <something> gives a bus error
...

RP3A0

from https://www.raspberrypi.com/documentation/computers/processors.html

The Raspberry Pi RP3A0 is our first System-in-Package (SiP) consisting of a Broadcom BCM2710A1 — which is the silicon die packaged inside the Broadcom BCM2837 chip which is used on the Raspberry Pi 3 — along with 512 MB of DRAM. It is used by the Raspberry Pi Zero 2 W.

The RP3A0 is a Quad-core 64-bit Arm Cortex A53 CPU clocked at 1 GHz, although with a heat sink or other cooling solution in place, the chip can be potentially overclocked to 1.2 GHz. Please refer to the BCM2836 document for details on the Arm peripherals specification, which also applies to the BCM2837 and RP3A0.

from https://pinout.xyz/pinout/pin21_gpio9/

we want to use GPIO 9 aka SMI SD1
..... ..... ..... .....
..... ..... X.... .....

no, actually GPIO 8 aka SMI SD0

QUESTIONS

do we need to know the current CPU speed?
/sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq

but it is changing w/ activity?

GPIO addresses

    0x 7e10 002c PADS (GPIO 0-27)

    0x 7e10 0030 PADS (GPIO 28-45)

    0x 7e10 0034 PADS (GPIO 46-53)

A Peripheral is a hardware device with a specific address in memory that it writes data to and/or reads data from. All peripherals can be described by an offset from the Peripheral Base Address, which starts at 0x20000000 on the Raspberry Pi model 1, and at 0x0x3F000000 on the models 2 and 3.

Peripheral Base Address and the GPIO Base Address?

cat /proc/iomem
3f200000.gpio gpio@7e200000

peripheral base address is 3f000000

The GPIO registers themselves are located at an offset from the peripheral base. For many models, the GPIO registers begin at an offset of 0x200000 from the peripheral base address.

BUT ... the code we're using was 32b and we MUST bump it to 64 bits!

RANDOM

total pulse is 1.25us
reset is 50us... to 300us depending on LED revision

0 is .4us + .85us
1 is .8us + .45us

though some tolerance seems to be OK (.35us for 0, .7us for 1..., 1.2us total...)

sequence = 24 bits GRB color, MSB first